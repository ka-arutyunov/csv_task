# Задача
## Вводные
Есть CSV-файл (https://disk.yandex.ru/d/npzjVSfFyH7Cww) с данными по рекомендациям одних товаров к другим, по одной рекомендации на строку:

sku_1,sku_recom_1,0.1
sku_2,sku_recom_2,0.2
…

Последний столбец (rank) содержит вероятность правильной рекомендации, то есть “близость” рекомендованного товара к исходному (чем больше значение — тем больше “близость”).

## Задание
1. Написать Web API на Python с одним эндпоинтом, который принимает sku в качестве параметра и возвращает список всех товаров, рекомендованных для этого sku. 
2. Должна быть возможность указать опциональный параметр минимального порога близости для рекомендаций.
3. Подготовить проект для деплоя (привести в порядок структуру проекта, проверить актуальность файла с зависимостями, создать README с примером запуска и т.д.)

## Ограничения на решение
1. Задача должна быть решена без использования сторонних библиотек и сервисов (вроде баз данных). Допустимо использование только стандартной библиотеки Python. Исключение: можно воспользоваться Flask или AIOHTTP для реализации Web API, но реализация только на стандартной библиотеке — плюс.
2. Модуль sqlite3 использовать нельзя.
3. CSV-файл можно предварительно подготовить другим инструментом, если нужно.
4. Максимальное время ответа API на запрос — 500 мс.
5. Максимальное потребление оперативной памяти сервером — 5 Гб.
6. При выборе между меньшей скоростью ответа на запрос и меньшим потреблением оперативной памяти предпочтение отдавать меньшей скорости ответа.

# Решение
## Запуск
Чтобы запустить данный код, достаточно написать python3 main.py Файл с зависимостями присутствует, хотя решение создано на стандартной библиотеке Python. При решении использовалась версия Python 3.9.1.

## Стадии работы
Первоначальная стадия занимает около 10 минут при указанном объеме входных данных и содержит следующие этапы:
1. Разбиение файла несортированных данных на мелкие отсортированные файлы. Количество строк в мелких файлах указывается в теле программы.
2. Слияние отсортированных файлов в большой отсортированный файл и удаление этих файлов.
3. Создание файла-индекса для ускорения поиска данных в отсортированном файле.
4. Загрузка файла-индекса в память.
5. Старт сервера.
6. При получении GET-запроса выполняется парсинг параметров sku и rank.
7. Остановка сервера производится через CMD+C
8. Дополнительно: при удачном выполнении стадий 1 - 3 и корректно созданных файле-индексе и отсортированном файле при последующих запусках эти стадии можно пропускать (закомментировать строки 247-254).

## Настроечные параметры
1. Предполагается, что все файловые манипуляции производятся в корневом каталоге (файл recommends.csv необходимо разместить в одной папке со скриптом).
2. Переменные index_file, sorted_file, input_file можно оставить по умолчанию, если исходный файл с данными действительно называется recommends.csv.
3. Переменная lines_in_little_file содержит количество строк, в файлах, на которые разбивается исходный файл — не рекомендуется указывать значения более 6 * 10 ** 6 (6 млн).
4. Переменная server_port содержит порт, который слушает сервер.

## Примеры GET-запросов:
1. http://localhost:8080/?sku=0ZpX1ajRTL&rank=0.8
2. http://localhost:8080/?sku=0ZpXnwYD70
